<html metal:use-macro="views/standard_macros/page">

<head>
  <title i18n:translate="">Undo Title</title>
  <link rel="stylesheet" type="text/css" href="/manage_page_style.css" />
</head>

<body>
<div metal:fill-slot="body">

  <form action="@@undo.html" method="post" 
        tal:define="first python:int(request.get('first',0)); 
                    all python:request.get('all', None)">

    <p class="form-help" i18n:translate="">
      This application's transactional feature allows you to easily undo
      changes made to the application's settings or data. You can revert the
      application to a &quot;snapshot&quot; of it's state at a previous point
      in time.
    </p>

    <p class="form-help" i18n:translate="">
      Select one or more transactions below and then click on the
      &quot;Undo&quot; button to undo those transactions.  Note that even
      though a transaction is shown below, you may not be able to undo it if
      later transactions modified objects that were modified by a selected
      transaction.
    </p>

    <span tal:condition="all">
      <p i18n:translate="">
        You are 
        <span tal:replace="request/user/id"
              i18n:name="username">username</span>, 
        looking at all transactions. <a href="?">View only your own 
        transactions</a>.
      </p>
      <span tal:omit-tag=""
          tal:define="global undoInfo python:view.getUndoInfo(first=first)"/>
    </span>

    <span tal:condition="not:all">
      <p i18n:translate="">You are 
        <span tal:replace="request/user/id"
              i18n:name="username">username</span>, 
        looking at your own transactions.  
        <a href="?all=yes">View everyone's transactions</a>.
      </p>
      <span tal:omit-tag=""
          tal:define="global undoInfo python:view.getUndoInfo(first=first,
                                             user_name=request.user.id)"/>
    </span>

    <p>
      <a tal:attributes="href python:'?first=%s'%(first+20)"
          i18n:translate="">View 20 earlier transactions</a>
    </p>

    <a name="t_list" />

    <table width="100%" cellspacing="0" cellpadding="2" border="0" >

      <div tal:repeat="undoitem undoInfo">
        <span tal:condition="repeat/undoitem/odd" >
          <span tal:define="global rowclass string:content odd"/> 
        </span>

        <span tal:condition="repeat/undoitem/even">
          <span tal:define="global rowclass string:content even"/> 
        </span>

        <tr tal:attributes="class rowclass">

          <td width="16" align="left" valign="top">
            <input type="checkbox" name="id_list:list" value="-1" 
                tal:attributes="value undoitem/id"/>
          </td>
          <td tal:attributes="class rowclass" align="left" valign="top">
            <div class="list-item">
     
              <i tal:condition="not:undoitem/description"
                 i18n:translate="">
                no description available
              </i>
              <span tal:condition="undoitem/description" tal:omit-tag=""
                tal:content="undoitem/description">description goes here</span>
              <span tal:condition="undoitem/user_name" tal:omit-tag=""
                  i18n:translate=""> by 
                <strong tal:content="undoitem/user_name"
                        i18n:name="username">user_name</strong>
              </span>
            </div>
          </td>

          <td align="right" valign="top" colspan="2" nowrap>
            <div class="list-item" tal:content="undoitem/datetime">
              blah date
            </div>
          </td>

        </tr>
      </div>

      <tr>
        <td>
          <input type="submit" value="Undo" 
              i18n:attributes="value undo-button"/>
        </td>
      </tr>
    </table>
  </form>

</div>
</body>
</html>


<!-- topmenu macro, render first level items with class name 'topmenu' -->
<metal:block define-macro="topmenu">
	<a href="" class="topmenu"
		 tal:attributes="href menuitem/action"
		 tal:content="menuitem/title"
		 i18n:translate="">
	</a>
  <div tal:condition="menuitem/submenu">
    <tal:block tal:repeat="subitem menuitem/submenu">
			<tal:block define="menuitem subitem">
				<metal:block use-macro="python:view.macros('submenu')" />
			</tal:block>
		</tal:block>
	</div>
</metal:block>

<!-- submenu macro, render all except first level items with class name 'item' -->
<metal:block define-macro="submenu2">
	<a href="" class="submenu"
		 tal:attributes="href menuitem/action"
		 tal:content="menuitem/title"
		 i18n:translate="">
	</a>
  <div tal:condition="menuitem/submenu">
    <tal:block tal:repeat="subitem menuitem/submenu">
			<tal:block define="menuitem subitem">
				<metal:block use-macro="python:view.macros('submenu')" />
			</tal:block>
		</tal:block>
	</div>
</metal:block>

<!-- item display macro -->
<metal:block define-macro="itemdisplay">
   <img class="itemicon"
        tal:condition="menuitem/icon"
        tal:attributes="src menuitem/icon" />
   &nbsp;
   <span tal:content="menuitem/title" />

   <img class="submenuhint" src="/++resource++submenuhint.png" 
        tal:condition="menuitem/submenu"/>
</metal:block>

<!-- menu item macro -->
<metal:block define-macro="submenu">
  <a href=""
     tal:attributes="href menuitem/action;">
    <metal:block use-macro="python:view.macros('itemdisplay')" />
  </a>
  <ul tal:condition="menuitem/submenu">
    <li tal:repeat="subitem menuitem/submenu">
      <tal:block define="menuitem subitem">
        <metal:block use-macro="python:view.macros('submenu')" />
      </tal:block>
    </li>
  </ul>
</metal:block>

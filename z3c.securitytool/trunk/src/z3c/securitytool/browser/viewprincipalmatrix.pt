<html>
    <head>
        <link type="text/css" rel="stylesheet" media="all" href=""
              tal:attributes="href context/++resource++securitytool.css"/>
    </head>
<body>
   <h1>Security Checking Tool</h1>
   <h2>View User Matrix</h2>
   <form action="." method="POST"
             tal:attributes="action request/URL">
      <p>Select a skin:
         <select name="selectedSkin">
            <option value="SkinType"
               tal:repeat="skinName view/skinTypes"
               tal:attributes="value skinName; 
               selected python:request.form.has_key('selectedSkin') and request.form['selectedSkin']==skinName"
               tal:content="skinName">SkinName</option>
         </select>
      </p>
      <p>Filter by permission:   
         <select name="selectedPermission">
            <option value="None">---</option>
            <option value="Permission"
               tal:repeat="permission view/getPermissionList"
               tal:attributes="value permission; 
               selected python:request.form.has_key('selectedPermission') and request.form['selectedPermission']==permission"
               tal:content="permission">permission</option>
         </select>
         
      <input type="submit" name="FILTER" value="Filter"/>
      </p>
   </form>
   <br />
   <table tal:define="urlViewName view/urlEncodedViewName" >
       <metal:block tal:repeat="viewObj view/viewList"
                    tal:attributes="class view/cssclass">
          <tr>
            <th align="left">
               <h2 tal:content="python: viewObj"/>
            </th>
            <th tal:repeat="principal view/viewMatrix">
                <a tal:content="principal"
                   tal:attributes="href string:ud.html?principal=${principal}">Principal</a>
            </th>
          </tr>

          <tr tal:repeat="viewItem python: view.viewList[viewObj]"
               tal:attributes="class view/cssclass">
               <td tal:content="viewItem" style="text-align: left"/>
                <td tal:repeat="principal view/viewMatrix"
                   tal:define="enc python:urlViewName[viewItem]">
                  <a tal:attributes="href string:pd.html?principal=${principal}&amp;view=${enc}"
                     tal:omit-tag="python: view.getPermissionSetting(viewItem,principal)=='--'">
                      <span tal:content="python: view.getPermissionSetting(viewItem,principal)"
                            tal:omit-tag="">Allow</span>
                  </a>
              </td>
           </tr>

       </metal:block>

   </table>
</body>
</html>

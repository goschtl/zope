<html>
    <head>
      <link type="text/css" rel="stylesheet" media="all" href=""
           tal:attributes="href context/++resource++securitytool.css"/>
    </head>
    <body>
       <h1>Security Checking Tool</h1>

       <div class="top_nav">
         <span class="top_nav_val"  onclick="javascript:history.back()"><u>Security Matrix</u>&nbsp|&nbsp</span>
         <span class="top_nav_val">Principal Settings </span>
       </div>
       <p class="description"> The detailed permissions, groups and
         roles for the selected principal are listed below. These are
         all the settings applied to the principal in the system
         regardless of the context or view. The settings Allow or Deny
         are also listed next to each permission.
       </p>
       <h1 class="just_border">&nbsp</h1>
       <div class="sub_heading">Permission settings for principal <em tal:content="view/principal"></em></div>
       <div class="legend" tal:condition="view/legend" tal:content="structure view/legend"/>
        <metal:block define-macro="user-details" 
                     tal:define="permissions view/principalPermissions/permissions;
                                 roles view/principalPermissions/roles;
                                 groups view/principalPermissions/groups">

              <tal:block tal:condition="permissions">
                  <h3>Directly provided permissions</h3>
                  <div tal:repeat="permission permissions">
                    <span tal:replace="permission">zope.ManageSite</span>
                  </div>
              </tal:block>
              <h3 tal:condition="roles">Permissions provided by roles</h3>
              <div class="contentList"  tal:condition="roles">
                <div tal:repeat="role roles">
                  <b tal:content="role">zope.ManageSite:</b>
                  <div tal:repeat="permission python:roles[role]">
                    <ul>
                      <li>
                       <div tal:content="permission/permission"/>
                       <div tal:attributes="class permission/setting"
                            tal:content="permission/setting"/>
                      </li>
                    </ul>
                  </div>
                  <br>

                </div>
              </div>

            <div class="contentList" tal:condition="groups">
              <br>
              <h3>Permissions provided by group(s)</h3>
                <div class="contentList" tal:repeat="group_id groups">
                  <div tal:content="group_id">zope.Authenticated</div>
                  <div tal:define="group python:groups[group_id];
                                   permissions group/permissions;
                                   roles group/roles;
                                   groups group/groups">
                   <div metal:use-macro="macro:user-details" />
                 </div>
                </div>
            </div>
          </metal:block>
    </body>
</html>

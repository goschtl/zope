<html>
<head>
  <link type="text/css" rel="stylesheet" media="all" href=""
        tal:attributes="href context/++resource++securitytool.css"/>
</head>
<body>
   <h1>Security Checking Tool</h1>
   <div class="top_nav">
     <a class="top_nav_val"  href="./securityMatrix.html">Security Matrix</a>&nbsp|&nbsp
     <span class="top_nav_val">Permission Settings </span>
   </div>
   <p class="description"> The permission settings for the
   intersection of the view and principal are displayed here. This
   view displays the permissions, roles, and groups applied to the
   view and principal previously selected on the securityMatrix.html
   page. These are the settings that directly determine what the
   security settings are for the intersection selected. You
   can go back to the matrix page by selecting the `Security
   Matrix` link above. </p>

   <div class="matrix_body">
       <h1 class="just_border">&nbsp</h1>
        <div class="sub_heading">
          <span  tal:content="structure view/message">This permission details
    	for the user </span>
        </div>
        <div class="legend"  
             tal:condition="view/legend" 
             tal:content="structure view/legend"/>
          <!--ul tal:condition="python: permissions or roles or groups"-->
            <metal:block define-macro="permission-details"
                   tal:define="permissions view/permissionDetails/permissions;
                               roles view/permissionDetails/roles;
                               groups view/permissionDetails/groups">
      
            <h3 tal:condition="permissions">Permissions directly
            responsible for access</h3>
            <div class="contentList"  tal:condition="permissions">
                <ul>
                <span tal:repeat="permission permissions">
                <li class="contentList">
                <span tal:content="view/read_perm"/>
                <span tal:attributes="class permission/setting" 
                       tal:content="permission/name"></span>
                </li>
                </span>
               
                </ul>

             </div>
             <br tal:condition="permissions">

              <h3 tal:condition="roles">Roles directly responsible for
              access</h3>
              <div class="contentList" tal:condition="roles">
                 <div tal:repeat="role_context roles">
                    <ul>
                    <li class="contentList">

                        <span tal:content="role_context" />: 
                        <span tal:repeat="perm
                                          python:roles[role_context]">
                            <span tal:attributes="class perm/setting" 
                                  tal:content="perm/name"/>
                            <span tal:condition="not:repeat/perm/end" 
                                  tal:replace="string:,"/>
                        </span>
                      </li>

                    </ul>
                  </div>
                </div>
                
                <b3 tal:condition="groups">Groups directly responsible
                for access</b3>
                <div class="contentList" tal:condition="groups">
                  <div tal:repeat="group_id groups">
                    <div tal:content="group_id">zope.Authenticated</div>
                    <div tal:define="group python:groups[group_id]; 
                                     permissions group/permissions; 
                                     roles group/roles; 
                                     groups group/groups">
                      <div metal:use-macro="macro:permission-details" />
                    </div>
                  </div>
                </div>
            </metal:block>
        </div>
    </body>
</html>

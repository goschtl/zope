       ##############################################################################
       #
       # Copyright (c) 2004 Zope Corporation and Contributors.
       # All Rights Reserved.
       #
       # This software is subject to the provisions of the Zope Public License,
       # Version 2.1 (ZPL).  A copy of the ZPL should accompany this distribution.
       # THIS SOFTWARE IS PROVIDED "AS IS" AND ANY AND ALL EXPRESS OR IMPLIED
       # WARRANTIES ARE DISCLAIMED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
       # WARRANTIES OF TITLE, MERCHANTABILITY, AGAINST INFRINGEMENT, AND FITNESS
       # FOR A PARTICULAR PURPOSE.
       #
       ##############################################################################
       """REST Tests
       
       $Id$
    1: """
    1: __docformat__ = "reStructuredText"
    1: import os
    1: import unittest
    1: import zope.component
    1: from zope.testing import doctest, doctestunit
    1: from zope.traversing.browser import absoluteurl
    1: from zope.traversing.interfaces import IContainmentRoot
    1: from zope.app.testing import functional, placelesssetup
    1: from z3c.rest import interfaces
       
    1: RESTLayer = functional.ZCMLLayer(
           os.path.join(os.path.split(__file__)[0], 'ftesting.zcml'),
    1:     __name__, 'RESTLayer', allow_teardown=True)
       
    1: def setUp(test):
    1:     placelesssetup.setUp(test)
       
           # XXX: This really needs a REST equivalent w/o breadcrumbs.
       
    1:     zope.component.provideAdapter(
               absoluteurl.AbsoluteURL,
    1:         (None, interfaces.IRESTRequest),
    1:         absoluteurl.IAbsoluteURL)
       
    1:     zope.component.provideAdapter(
               absoluteurl.SiteAbsoluteURL,
    1:         (IContainmentRoot, interfaces.IRESTRequest),
    1:         absoluteurl.IAbsoluteURL,
    1:         'absolute_url')
       
    1:     zope.component.provideAdapter(
               absoluteurl.SiteAbsoluteURL,
    1:         (IContainmentRoot, interfaces.IRESTRequest),
    1:         absoluteurl.IAbsoluteURL)
       
    1:     zope.component.provideAdapter(
               absoluteurl.AbsoluteURL,
    1:         (None, interfaces.IRESTRequest),
    1:         absoluteurl.IAbsoluteURL,
    1:         'absolute_url')
       
       
    1: def test_suite():
    1:     client = functional.FunctionalDocFileSuite('../client.txt')
    1:     client.layer = RESTLayer
    1:     return unittest.TestSuite((
               client,
               doctest.DocFileSuite(
                   '../rest.txt',
    1:             globs={'pprint': doctestunit.pprint},
    1:             optionflags=doctest.NORMALIZE_WHITESPACE|doctest.ELLIPSIS,
                   ),
               doctest.DocFileSuite(
                   '../null.txt',
    1:             setUp=setUp, tearDown=placelesssetup.tearDown,
    1:             optionflags=doctest.NORMALIZE_WHITESPACE|doctest.ELLIPSIS,
                   ),
               doctest.DocFileSuite(
                   '../traverser.txt',
    1:             optionflags=doctest.NORMALIZE_WHITESPACE|doctest.ELLIPSIS,
                   ),
               ))

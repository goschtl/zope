
    <html>
      <head><title>Unit test coverage for z3c.rest.rest</title>
      <style type="text/css">
        a {text-decoration: none; display: block; padding-right: 1em;}
        a:hover {background: #EFA;}
        hr {height: 1px; border: none; border-top: 1px solid gray;}
        .notcovered {background: #FCC;}
        .footer {margin: 2em; font-size: small; color: gray;}
      </style>
      </head>
      <body><h1>Unit test coverage for z3c.rest.rest</h1>
      <table>
    
<tr><td><a href="z3c.html">z3c/</a></td> <td style="background: green">&nbsp;&nbsp;&nbsp;&nbsp;</td> <td>covered 100% (0 of 282 uncovered)</td></tr>
<tr><td><a href="z3c.rest.html">&nbsp;&nbsp;&nbsp;&nbsp;rest/</a></td> <td style="background: green">&nbsp;&nbsp;&nbsp;&nbsp;</td> <td>covered 100% (0 of 282 uncovered)</td></tr>
<tr><td><a href="z3c.rest.rest.html">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rest.py</a></td> <td style="background: green">&nbsp;&nbsp;&nbsp;&nbsp;</td> <td>covered 100% (0 of 50 uncovered)</td></tr>
</table><hr/>
<pre>
       <I><FONT COLOR="#B22222">##############################################################################
</FONT></I>       <I><FONT COLOR="#B22222">#
</FONT></I>       <I><FONT COLOR="#B22222"># Copyright (c) 2007 Zope Corporation and Contributors.
</FONT></I>       <I><FONT COLOR="#B22222"># All Rights Reserved.
</FONT></I>       <I><FONT COLOR="#B22222">#
</FONT></I>       <I><FONT COLOR="#B22222"># This software is subject to the provisions of the Zope Public License,
</FONT></I>       <I><FONT COLOR="#B22222"># Version 2.1 (ZPL).  A copy of the ZPL should accompany this distribution.
</FONT></I>       <I><FONT COLOR="#B22222"># THIS SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ANY AND ALL EXPRESS OR IMPLIED
</FONT></I>       <I><FONT COLOR="#B22222"># WARRANTIES ARE DISCLAIMED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
</FONT></I>       <I><FONT COLOR="#B22222"># WARRANTIES OF TITLE, MERCHANTABILITY, AGAINST INFRINGEMENT, AND FITNESS
</FONT></I>       <I><FONT COLOR="#B22222"># FOR A PARTICULAR PURPOSE.
</FONT></I>       <I><FONT COLOR="#B22222">#
</FONT></I>       <I><FONT COLOR="#B22222">##############################################################################
</FONT></I>       <B><FONT COLOR="#BC8F8F">&quot;&quot;&quot;REST publication and publisher factories
       
       $Id: http.py 72310 2007-02-01 21:39:01Z mkerrin $
    1: &quot;&quot;&quot;</FONT></B>
    1: <B><FONT COLOR="#A020F0">import</FONT></B> cgi
    1: <B><FONT COLOR="#A020F0">import</FONT></B> zope.interface
    1: <B><FONT COLOR="#A020F0">from</FONT></B> zope.app.publication.interfaces <B><FONT COLOR="#A020F0">import</FONT></B> IPublicationRequestFactory
    1: <B><FONT COLOR="#A020F0">from</FONT></B> zope.app.publication.http <B><FONT COLOR="#A020F0">import</FONT></B> HTTPPublication
    1: <B><FONT COLOR="#A020F0">from</FONT></B> zope.publisher.http <B><FONT COLOR="#A020F0">import</FONT></B> HTTPRequest
       
    1: <B><FONT COLOR="#A020F0">from</FONT></B> z3c.rest <B><FONT COLOR="#A020F0">import</FONT></B> interfaces
       
    2: <B><FONT COLOR="#A020F0">class</FONT></B> RESTRequest(HTTPRequest):
    1:     zope.interface.implements(interfaces.IRESTRequest)
       
    1:     __slots__ = (
               <B><FONT COLOR="#BC8F8F">'parameters'</FONT></B>, <I><FONT COLOR="#B22222"># Parameters sent via the query string.
</FONT></I>               )
       
    1:     <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">__init__</FONT></B>(self, body_instream, environ, response=None):
   39:         self.parameters = {}
   39:         super(RESTRequest, self).__init__(body_instream, environ, response)
       
    1:     <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">processInputs</FONT></B>(self):
               <B><FONT COLOR="#BC8F8F">'See IPublisherRequest'</FONT></B>
   35:         <B><FONT COLOR="#A020F0">if</FONT></B> <B><FONT COLOR="#BC8F8F">'QUERY_STRING'</FONT></B> <B><FONT COLOR="#A020F0">not</FONT></B> <B><FONT COLOR="#A020F0">in</FONT></B> self._environ:
   31:             <B><FONT COLOR="#A020F0">return</FONT></B>
               <I><FONT COLOR="#B22222"># Parse the query string into our parameters dictionary.
</FONT></I>    4:         self.parameters = cgi.parse_qs(
                   self._environ[<B><FONT COLOR="#BC8F8F">'QUERY_STRING'</FONT></B>], keep_blank_values=1)
               <I><FONT COLOR="#B22222"># Since the parameter value is always a list (sigh), let's at least
</FONT></I>               <I><FONT COLOR="#B22222"># detect single values and store them.
</FONT></I>   11:         <B><FONT COLOR="#A020F0">for</FONT></B> name, value <B><FONT COLOR="#A020F0">in</FONT></B> self.parameters.items():
    7:             <B><FONT COLOR="#A020F0">if</FONT></B> len(value) == 1:
    6:                 self.parameters[name] = value[0]
       
    1:     <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">keys</FONT></B>(self):
               <B><FONT COLOR="#BC8F8F">'See Interface.Common.Mapping.IEnumerableMapping'</FONT></B>
    7:         d = {}
    7:         d.update(self._environ)
    7:         d.update(self.parameters)
    7:         <B><FONT COLOR="#A020F0">return</FONT></B> d.keys()
       
    1:     <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">get</FONT></B>(self, key, default=None):
               <B><FONT COLOR="#BC8F8F">'See Interface.Common.Mapping.IReadMapping'</FONT></B>
  300:         marker = object()
  300:         result = self.parameters.get(key, marker)
  300:         <B><FONT COLOR="#A020F0">if</FONT></B> result <B><FONT COLOR="#A020F0">is</FONT></B> <B><FONT COLOR="#A020F0">not</FONT></B> marker:
    8:             <B><FONT COLOR="#A020F0">return</FONT></B> result
       
  292:         <B><FONT COLOR="#A020F0">return</FONT></B> super(RESTRequest, self).get(key, default)
       
       
    2: <B><FONT COLOR="#A020F0">class</FONT></B> RESTView(object):
    1:     zope.interface.implements(interfaces.IRESTView)
       
    1:     <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">__init__</FONT></B>(self, context, request):
   39:         self.context = context
   39:         self.request = request
       
    1:     @apply
           <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">__parent__</FONT></B>():
    1:         <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">get</FONT></B>(self):
    2:             <B><FONT COLOR="#A020F0">return</FONT></B> getattr(self, <B><FONT COLOR="#BC8F8F">'_parent'</FONT></B>, self.context)
    1:         <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">set</FONT></B>(self, parent):
    1:             self._parent = parent
    1:         <B><FONT COLOR="#A020F0">return</FONT></B> property(get, set)
       
       
    2: <B><FONT COLOR="#A020F0">class</FONT></B> RESTPublicationRequestFactory(object):
    1:     zope.interface.implements(IPublicationRequestFactory)
       
    1:     <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">__init__</FONT></B>(self, db):
               <B><FONT COLOR="#BC8F8F">&quot;&quot;&quot;See zope.app.publication.interfaces.IPublicationRequestFactory&quot;&quot;&quot;</FONT></B>
    2:         self.publication = HTTPPublication(db)
       
    1:     <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">__call__</FONT></B>(self, input_stream, env, output_stream=None):
               <B><FONT COLOR="#BC8F8F">&quot;&quot;&quot;See zope.app.publication.interfaces.IPublicationRequestFactory&quot;&quot;&quot;</FONT></B>
    5:         request = RESTRequest(input_stream, env)
    5:         request.setPublication(self.publication)
    5:         <B><FONT COLOR="#A020F0">return</FONT></B> request
</pre>

      <div class="footer">
      Generated for revision exported on 2007-11-30 11:34:55.110922Z
      </div>
    </body>
    </html>

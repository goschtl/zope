<html metal:use-macro="context/@@standard_macros/view"
    i18n:domain="zope">
<body>

<div metal:fill-slot="user_details">
    <div id="userDetails">
        <span>Online:</span>
        <span id="online">
            <tal:block replace="view/whoIsOnline">
                  User
            </tal:block>
        </span>
        &nbsp;&nbsp;&nbsp;
        <span tal:omit-tag="" i18n:translate="">User:</span>
        <tal:block replace="request/principal/title">
                User
        </tal:block>
    </div>
</div>
            
<div metal:fill-slot="body">

    <script type="text/javascript" src="prototype.js" 
       tal:attributes="src string:${context/++resource++zorgajax/prototype.js}">
    </script>
    <script type="text/javascript" src="json.js" 
       tal:attributes="src string:${context/++resource++json.js}">
    </script>
    <script type="text/javascript" src="livepage.js" 
       tal:attributes="src string:${context/++resource++livepage.js}">
    </script>
    <script type="text/javascript" src="livecomment.js" 
       tal:attributes="src string:${context/++resource++livecomment.js}">
    </script>
    <script type="text/javascript" src="effects.js"
       tal:attributes="src string:${context/++resource++zorgajax/effects.js}">
    </script>
    <script type="text/javascript" src="movies.js"
       tal:attributes="src string:${context/++resource++movies.js}">
    </script>
    <script type="text/vbscript" src="movies.vbs"
       tal:attributes="src string:${context/++resource++movies.vbs}">
    </script>
    
    <script type="text/javascript" 
            tal:content="string:LivePage.uuid = '${view/nextClientId}';">
            LivePage.uuid = '0';
    </script>
    
     <script type="text/javascript">
        LivePage.startClient();
        window.onunload = LivePage.stopClient
    </script>  

	<div id="flashSound" style="height: 0px;
	                     visibility: hidden;">
		<object id="ping" src="signal.swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="0" height="0"
		    tal:attributes="src string:${context/++resource++signal.swf}"
			>
			<param name="quality" value="high">
			<embed name="ping" src="signal.swf" type="application/x-shockwave-flash" width="0" height="0" swLiveConnect="true"
			    tal:attributes="src string:${context/++resource++signal.swf}"
				/>
		</object>
	</div>

    
   <p>Type a comment and see how the page
    updates automatically. Open the same LiveComment page in a second browser
    and observe how others are immediately notified about your typing.</p>

    <div>List of Comments</div>
        <div id="comments_area"
             style="display: block;
                    border: 1px solid #CCCCCC;
                    padding: 2px 4px;
                    margin-top: .3em;
                    width: 800px;
                    height: 300px;
                    overflow: auto;"

                tal:content="structure view/renderComments">
    </div>
  
   <form action="addComment"
        onsubmit="saveComment($('commentbox')); return false;"
        onreset="cancelComment();"
        method="post">

    <div class="row">
      <div class="label" i18n:translate="">Live Comment <span id="update_feedback"></span> </div>
        <input id="comment_key" type="hidden" name="key:int" value="" />
      <div class="field">
        <textarea style="width: 30em; border: 1px solid gray;" id="commentbox" name="text" rows="5" cols="10"></textarea>
      </div>
    </div>

    <script type="text/javascript">
        installTextObserver();
    </script>  
    
    <div class="row">
      <div class="controls">
        <input type="submit" name="save" value="Save Comment"
            i18n:attributes="value save-comment-button"/>
        <input type="reset" name="cancel" value="Cancel"
            i18n:attributes="value cancel-comment-button"/>
      </div>
    </div>
    <div id="event_count">?</div>
  </form>

</div>
</body>
</html>

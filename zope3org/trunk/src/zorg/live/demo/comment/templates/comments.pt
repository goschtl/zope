<html metal:use-macro="context/@@standard_macros/view"
    i18n:domain="zope">
<body>

<div metal:fill-slot="user_details">
    <div id="userDetails">
        <span>Online:</span>
        <span id="online">
            <tal:block replace="view/whoIsOnline">
                  User
            </tal:block>
        </span>
        &nbsp;&nbsp;&nbsp;
        <span tal:omit-tag="" i18n:translate="">User:</span>
        <tal:block replace="request/principal/title">
                User
        </tal:block>
    </div>
</div>
            
<div metal:fill-slot="body">

    <script type="text/javascript" src="prototype.js" 
       tal:attributes="src string:${context/++resource++zorgajax/prototype.js}">
    </script>
    <script type="text/javascript" src="livepage.js" 
       tal:attributes="src string:${context/++resource++livepage.js}">
    </script>
    <script type="text/javascript" src="livecomment.js" 
       tal:attributes="src string:${context/++resource++livecomment.js}">
    </script>
    
    <script type="text/javascript" 
            tal:content="string:var livePageUUID = '${view/nextClientId}';">
        var livePageClientUUID = '0';
    </script>
    
     <script type="text/javascript">
        startClient();
        
        window.onunload = stopClient
    </script>  
    
   <p>Type a comment and see how the page
    updates automatically. Open the same LiveComment page in a second browser
    and observe how others are immediately notified about your typing.</p>

    <div>List of Comments</div>
        <div id="comments" 
             style="display: block;
                    border: 1px solid #CCCCCC;
                    padding: 2px 4px;
                    margin-top: .3em;
                    width: 800px;
                    height: 300px;
                    overflow: auto;"

                tal:content="structure view/renderComments">
    </div>
  
   <form action="addComment"
        onsubmit="saveComment($('commentbox')); return false;"
        onreset="cancelComment();"
        method="post">

    <div class="row">
      <div class="label" i18n:translate="">Live Comment <span id="update_feedback"></span> </div>
        <input id="comment_key" type="hidden" name="key:int" value="" />
      <div class="field">
        <textarea style="width: 30em; border: 1px solid gray;" id="commentbox" name="text" rows="5" cols="10"></textarea>
      </div>
    </div>

    <script type="text/javascript">
        installTextObserver();
    </script>  
    
    <div class="row">
      <div class="controls">
        <input type="submit" name="save" value="Save Comment"
            i18n:attributes="value save-comment-button"/>
        <input type="reset" name="cancel" value="Cancel"
            i18n:attributes="value cancel-comment-button"/>
      </div>
    </div>

  </form>

</div>
</body>
</html>

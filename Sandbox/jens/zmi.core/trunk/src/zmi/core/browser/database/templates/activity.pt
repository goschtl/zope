<html>
<head>
<title>Recent Database Activity</title>
<style>

div#chart table {
border: 1px solid gray;
 font-size:75%;
  }

 tr td a {
  text-decoration: none;
 }

 .red,
 tr.red a {
  color: #F00;
  }

 .blue,
 tr.blue a{
  color: #000080;
  }

 td {
  width: 3.5em;
  text-align: right;
  }

 td.title {
  text-align: left;
  width: auto;
  }

 td.total,
 td.title {
  font-weight: bold;
  }


 span.bar {
   display:block;
   color: #FFF;
   float: left;
   width: 3em;
   vertical-align: bottom;
   }

 span.blue {
   background-color: #000080;
   }

 span.red {
   background-color: #F00;
   }

</style>
</head>
<body tal:define="activity view/getActivityChartData">

<nav>
  <ul>
    <li><a href="./zodb_overview.html">Overview</a></li>
    <li><a href="./zodb_activity.html">Activity</li>
    <li><a href="./zodb_parameters.html">Cache Parameters</li>
    <li><a href="./zodb_flush.html">Flush Cache</li>
  </ul>
</nav>

<h1>Recent Database Activity</h1>

 <h2>Keep History (seconds)</h2>

  <form method="POST" action="./" tal:attributes="action request/URL">
   <input type="text" name="length"
          tal:attributes="value view/getHistoryLength" />
   <input type="submit" name="set_history" value="Save changes" />
  </form>

 <h2>Displayed Range</h2>
 <span tal:content="activity/start_time"> </span> to<br />
 <span tal:content="activity/end_time"></span>

  <form method="POST" action="./" tal:attributes="action request/URL">
   <input type="submit" name="current_chart" value="Show current chart" />
  </form>

<table id="chart">

 <tr>
  <td></td>
  <td valign="bottom" tal:repeat="result activity/divs">
   <a href=""
    tal:attributes="href string: ${request/URL}?${result/link}">
   <span class="bar red"
        tal:content="python: result['stores'] > 0 and result['stores'] or None"
        tal:attributes="style string:height: ${result/store_len}"></span>
   <span class="bar blue"
        tal:content="python: result['loads'] > 0 and result['loads'] or None"
        tal:attributes="style string:height: ${result/load_len}"></span>
   </a>
 </td>
</tr>

 <tr>
  <td colspan="11"></td>
  <td class="total">Total</td>
 </tr>
 <tr class="red">
  <td class="title">Object stores</td>
  <td tal:repeat="result activity/divs">
   <a href="" tal:content="result/stores"
    tal:attributes="href string: ${request/URL}?${result/link}"></a>
 </td>
 <td class="total" tal:content="activity/total_store_count">total_store_count</td>
</tr>

 <tr class="blue">
  <td class="title">Object loads</td>
  <td tal:repeat="result activity/divs">
   <a href="" tal:content="result/loads"
    tal:attributes="href string: ${request/URL}?${result/link}"></a>
 </td>
 <td class="total" tal:content="activity/total_load_count">total_load_count</td>
</tr>

 <tr>
  <td class="title">Connections</td>
  <td tal:repeat="result activity/divs"
     tal:content="result/connections">Connections
 </td>
 <td class="total" tal:content="activity/total_connections">total_connections</td>
</tr>

 <tr>
  <td>Time offset</td>
  <td tal:repeat="result activity/divs"
     tal:content="result/time_offset">Time offset
 </td>
</tr>
</table>

</body>
</html>
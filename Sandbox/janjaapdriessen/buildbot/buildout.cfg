[buildout]
parts = master
        ${py2.4:result-sections}
        ${win-py2.4:result-sections}
        ${py2.5:result-sections}
        ${win-py2.5:result-sections}
        ${py2.6:result-sections}
        ${win-py2.6:result-sections}
        ${py2.7:result-sections}
        ${win-py2.7:result-sections}
        poller
        slaves
        reboot-slaves
versions = versions
extensions = mr.developer
auto-checkout = collective.buildbot
always-checkout = true
allow-picked-versions = false

[sources]
collective.buildbot = svn http://svn.plone.org/svn/collective/collective.buildbot/trunk

[versions]
argparse = 1.1
buildbot = 0.7.12
distribute = 0.6.14
manuel = 1.3.0
mr.developer = 1.16
Paste = 1.7.5.1
PasteDeploy = 1.3.4
PasteScript = 1.7.3
setuptools = 0.6c11
Twisted = 10.1.0
virtualenv = 1.5.1
z3c.recipe.scripts = 1.0.1
z3c.recipe.usercrontab = 1.0
zc.buildout = 1.5.1
zc.recipe.egg = 1.3.2
zc.recipe.macro = 1.3.0
zc.recipe.testrunner = 1.4.0
zope.exceptions = 3.6.1
zope.interface = 3.6.1
zope.testing = 3.10.0
zope.testrunner = 4.0.0b5

[master]
recipe = collective.buildbot:master
project-name = Zope Buildbot
max-builds = 1
allow-force = true
slaves =
    slave-ubuntu32 secret
    slave-ubuntu64 secret
    slave-osx secret
    slave-win secret

[slaves]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:slave
macro = slave-macro
targets = slave-ubuntu32
          slave-ubuntu64
          slave-osx
          slave-win

[slave-macro]
environment = buildslave_environment
host = localhost
port = 8999
password = secret

[buildslave_environment]
GOCEPT_SELENIUM_SERVER_HOST = localhost
GOCEPT_SELENIUM_APP_HOST = 0.0.0.0

[poller]
recipe = collective.buildbot:poller
repositories = http://svn.zope.org/repos/main
poll-interval = 3600

[project-macro]
slave-names = $${:slaves}
vcs = $${:_vcs}
vcs-mode = $${:_vcs_mode}
repositories = $${:repos}
mail-host = localhost
email-notification-sender = no-reply@localhost
email-notification-recipients = $${:mailto}
mail-mode = $${:mailmode}
build-sequence =
    $${:info}
    $${:bootstrap}
    $${:buildout}
test-sequence = $${:test}
periodic-scheduler = 1440
email-zope-test-style = True
test-timeout = $${:_test_timeout}
# sensible defaults
_vcs = svn
_vcs_mode = clobber
_test_timeout = 3600
test = bin/test --all
info = svn info .
buildout = bin/buildout -v
mailmode = failing
mailto = root@localhost
bootstrap = python bootstrap.py
slaves = slave-ubuntu32
         slave-ubuntu64
         slave-osx

[project-macro-py2.4]
<= project-macro
bootstrap = python2.4 bootstrap.py

[project-macro-py2.5]
<= project-macro
bootstrap = python2.5 bootstrap.py

[project-macro-py2.6]
<= project-macro
bootstrap = python2.6 bootstrap.py

[project-macro-py2.7]
<= project-macro
bootstrap = python2.7 bootstrap.py

[project-macro-win-py2.4]
<= project-macro
slaves = slave-win
bootstrap = C:\Python24\python bootstrap.py
buildout = bin\buildout -v
test = bin\test --all

[project-macro-win-py2.5]
<= project-macro
slaves = slave-win
bootstrap = C:\Python25\python bootstrap.py
buildout = bin\buildout -v
test = bin\test --all

[project-macro-win-py2.6]
<= project-macro
slaves = slave-win
bootstrap = C:\Python26\python bootstrap.py
buildout = bin\buildout -v
test = bin\test --all

[project-macro-win-py2.7]
<= project-macro
slaves = slave-win
bootstrap = C:\Python27\python bootstrap.py
buildout = bin\buildout -v
test = bin\test --all

[py2.4]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:project
macro = project-macro-py2.4
targets = zopetoolkit-1.0-py2.4:zopetoolkit-1.0_parameters

[win-py2.4]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:project
macro = project-macro-win-py2.4
targets = zopetoolkit-1.0_win-py2.4:zopetoolkit-1.0_parameters-win

[py2.5]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:project
macro = project-macro-py2.5
targets = trunks-py2.5:trunk_repos_plus_crontab_grokproject_C_extentions_proxy
          zopetoolkit-1.0-py2.5:zopetoolkit-1.0_parameters
          zopetoolkit-1.1-py2.5:zopetoolkit-1.1_parameters
          zopetoolkit-py2.5:zopetoolkit_parameters
          groktoolkit-py2.5:groktoolkit_parameters
          groktoolkit-1.2-py2.5:groktoolkit-1.2_parameters

[win-py2.5]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:project
macro = project-macro-win-py2.5
targets = trunks-win-py2.5:trunk_repos
          zopetoolkit-1.0_win-py2.5:zopetoolkit-1.0_parameters-win
          zopetoolkit-1.1_win-py2.5:zopetoolkit-1.1_parameters-win
          zopetoolkit_win-py2.5:zopetoolkit_parameters-win
          groktoolkit_win-py2.5:groktoolkit_parameters-win
          groktoolkit-1.2_win-py2.5:groktoolkit-1.2_parameters-win

[py2.6]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:project
macro = project-macro-py2.6
targets = trunks-py2.6:trunk_repos_plus_crontab_grokproject_C_extentions_proxy
          zopetoolkit-1.0-py2.6:zopetoolkit-1.0_parameters
          zopetoolkit-1.1-py2.6:zopetoolkit-1.1_parameters
          zopetoolkit-py2.6:zopetoolkit_parameters
          groktoolkit-py2.6:groktoolkit_parameters
          groktoolkit-1.2-py2.6:groktoolkit-1.2_parameters
          zope2.12-py2.6:zope2.12_parameters
          zope2.13-py2.6:zope2.13_parameters
          zope2.14-py2.6:zope2.14_parameters
          gocept.selenium-selenium:gocept.selenium-selenium-parameters
          gocept.selenium-static:gocept.selenium-static-parameters
          gocept.selenium-wsgi:gocept.selenium-wsgi-parameters
          gocept.selenium-ztk:gocept.selenium-ztk-parameters
          gocept.selenium-zope210:gocept.selenium-zope210-parameters
          gocept.selenium-zope212:gocept.selenium-zope212-parameters
          gocept.selenium-grok:gocept.selenium-grok-parameters
          gocept.selenium-plone3:gocept.selenium-plone3-parameters
          gocept.selenium-plone4:gocept.selenium-plone4-parameters
          gocept.selenium-plonetesting-zope210:gocept.selenium-plonetesting-zope210-parameters
          gocept.selenium-plonetesting-zope212:gocept.selenium-plonetesting-zope212-parameters
          gocept.selenium-plonetesting-plone3:gocept.selenium-plonetesting-plone3-parameters
          gocept.selenium-plonetesting-plone3-zope211:gocept.selenium-plonetesting-plone3-zope211-parameters
          gocept.selenium-plonetesting-plone4:gocept.selenium-plonetesting-plone4-parameters
          fanstatic:fanstatic-parameters
          zope.fanstatic:zope.fanstatic-parameters
          zope.pytest:zope.pytest-parameters

[win-py2.6]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:project
macro = project-macro-win-py2.6
targets = trunks-win-py2.6:trunk_repos
          zopetoolkit-1.0_win-py2.6:zopetoolkit-1.0_parameters-win
          zopetoolkit-1.1_win-py2.6:zopetoolkit-1.1_parameters-win
          zopetoolkit_win-py2.6:zopetoolkit_parameters-win
          groktoolkit_win-py2.6:groktoolkit_parameters-win
          groktoolkit-1.2_win-py2.6:groktoolkit-1.2_parameters-win
          zope2.13_win-py2.6:zope2.13_parameters-win
          fanstatic-win:fanstatic-parameters-win
          zope.fanstatic-win:zope.fanstatic-parameters

[py2.7]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:project
macro = project-macro-py2.7
targets = trunks-py2.7:trunk_repos_plus_crontab_grokproject_C_extentions
# disable until 2.7 support          zopetoolkit-py2.7:zopetoolkit_parameters
          groktoolkit-py2.7:groktoolkit_parameters
          zope2.13-py2.7:zope2.13_parameters
          zope2.14-py2.7:zope2.14_parameters

[win-py2.7]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:project
macro = project-macro-win-py2.7
targets = trunks-win-py2.7:trunk_repos
# disable until 2.7 support          zopetoolkit_win-py2.7:zopetoolkit_parameters-win
          groktoolkit_win-py2.7:groktoolkit_parameters-win
          zope2.13_win-py2.7:zope2.13_parameters-win

[trunk_repos]
repos =
# Grok Toolkit packages.
    http://svn.zope.org/repos/main/grokcore.annotation/trunk
    http://svn.zope.org/repos/main/grokcore.component/trunk
    http://svn.zope.org/repos/main/grokcore.content/trunk
    http://svn.zope.org/repos/main/grokcore.formlib/trunk
    http://svn.zope.org/repos/main/grokcore.message/trunk
    http://svn.zope.org/repos/main/grokcore.rest/trunk
    http://svn.zope.org/repos/main/grokcore.security/trunk
    http://svn.zope.org/repos/main/grokcore.site/trunk
    http://svn.zope.org/repos/main/grokcore.startup/trunk
    http://svn.zope.org/repos/main/grokcore.traverser/trunk
    http://svn.zope.org/repos/main/grokcore.viewlet/trunk
    http://svn.zope.org/repos/main/grokcore.view/trunk
    http://svn.zope.org/repos/main/grokcore.xmlrpc/trunk
    http://svn.zope.org/repos/main/grok/trunk
    http://svn.zope.org/repos/main/grokui.admin/trunk
    http://svn.zope.org/repos/main/grokui.base/trunk
    http://svn.zope.org/repos/main/martian/branches/0.11
    http://svn.zope.org/repos/main/martian/trunk
    http://svn.zope.org/repos/main/megrok.strictrequire/trunk
    http://svn.zope.org/repos/main/z3c.autoinclude/trunk
    http://svn.zope.org/repos/main/z3c.flashmessage/trunk
    http://svn.zope.org/repos/main/z3c.recipe.compattest/trunk
    http://svn.zope.org/repos/main/zc.catalog/trunk
# Zope Toolkit packages, excluding C-extensions, excluding zope.app.*
    http://svn.zope.org/repos/main/zope.annotation/trunk
    http://svn.zope.org/repos/main/zope.applicationcontrol/trunk
    http://svn.zope.org/repos/main/zope.authentication/trunk
    http://svn.zope.org/repos/main/zope.browsermenu/trunk
    http://svn.zope.org/repos/main/zope.browserpage/trunk
    http://svn.zope.org/repos/main/zope.browserresource/trunk
    http://svn.zope.org/repos/main/zope.browser/trunk
    http://svn.zope.org/repos/main/zope.cachedescriptors/trunk
    http://svn.zope.org/repos/main/zope.catalog/trunk
    http://svn.zope.org/repos/main/zope.component/trunk
    http://svn.zope.org/repos/main/zope.componentvocabulary/trunk
    http://svn.zope.org/repos/main/zope.configuration/trunk
    http://svn.zope.org/repos/main/zope.contentprovider/trunk
    http://svn.zope.org/repos/main/zope.contenttype/trunk
    http://svn.zope.org/repos/main/zope.copypastemove/trunk
    http://svn.zope.org/repos/main/zope.copy/trunk
    http://svn.zope.org/repos/main/zope.datetime/trunk
    http://svn.zope.org/repos/main/zope.deferredimport/trunk
    http://svn.zope.org/repos/main/zope.deprecation/trunk
    http://svn.zope.org/repos/main/zope.dottedname/trunk
    http://svn.zope.org/repos/main/zope.dublincore/trunk
    http://svn.zope.org/repos/main/zope.error/trunk
    http://svn.zope.org/repos/main/zope.event/trunk
    http://svn.zope.org/repos/main/zope.exceptions/trunk
    http://svn.zope.org/repos/main/zope.filerepresentation/trunk
    http://svn.zope.org/repos/main/zope.formlib/trunk
    http://svn.zope.org/repos/main/zope.i18n/trunk
    http://svn.zope.org/repos/main/zope.intid/trunk
    http://svn.zope.org/repos/main/zope.keyreference/trunk
    http://svn.zope.org/repos/main/zope.lifecycleevent/trunk
    http://svn.zope.org/repos/main/zope.location/trunk
    http://svn.zope.org/repos/main/zope.login/trunk
    http://svn.zope.org/repos/main/zope.mimetype/trunk
    http://svn.zope.org/repos/main/zope.minmax/trunk
    http://svn.zope.org/repos/main/zope.pagetemplate/trunk
    http://svn.zope.org/repos/main/zope.password/trunk
    http://svn.zope.org/repos/main/zope.pluggableauth/trunk
    http://svn.zope.org/repos/main/zope.principalannotation/trunk
    http://svn.zope.org/repos/main/zope.principalregistry/trunk
    http://svn.zope.org/repos/main/zope.processlifetime/trunk
    http://svn.zope.org/repos/main/zope.ptresource/trunk
    http://svn.zope.org/repos/main/zope.publisher/trunk
    http://svn.zope.org/repos/main/zope.ramcache/trunk
    http://svn.zope.org/repos/main/zope.schema/trunk
    http://svn.zope.org/repos/main/zope.securitypolicy/trunk
    http://svn.zope.org/repos/main/zope.sendmail/trunk
    http://svn.zope.org/repos/main/zope.sequencesort/trunk
    http://svn.zope.org/repos/main/zope.server/trunk
    http://svn.zope.org/repos/main/zope.session/trunk
    http://svn.zope.org/repos/main/zope.site/trunk
    http://svn.zope.org/repos/main/zope.size/trunk
    http://svn.zope.org/repos/main/zope.structuredtext/trunk
    http://svn.zope.org/repos/main/zope.tales/trunk
    http://svn.zope.org/repos/main/zope.tal/trunk
    http://svn.zope.org/repos/main/zope.testing/trunk
    http://svn.zope.org/repos/main/zope.testrunner/trunk
    http://svn.zope.org/repos/main/zope.traversing/trunk
    http://svn.zope.org/repos/main/zope.viewlet/trunk
    http://svn.zope.org/repos/main/zope.errorview/trunk
# zope.app.* dependencies for Grok Toolkit
    http://svn.zope.org/repos/main/zope.app.applicationcontrol/trunk
    http://svn.zope.org/repos/main/zope.app.appsetup/trunk
    http://svn.zope.org/repos/main/zope.app.debug/trunk
    http://svn.zope.org/repos/main/zope.app.http/trunk
    http://svn.zope.org/repos/main/zope.app.publication/trunk
    http://svn.zope.org/repos/main/zope.app.wsgi/trunk
    http://svn.zope.org/repos/main/zope.app.generations/trunk
# z3c packages
    http://svn.zope.org/repos/main/z3c.schema/trunk


# trunk_repos + crontab, grokproject and projects with C-extensions.
[trunk_repos_plus_crontab_grokproject_C_extentions]
repos = ${trunk_repos:repos}
        http://svn.zope.org/repos/main/z3c.recipe.usercrontab/trunk
        http://svn.zope.org/repos/main/zope.hookable/trunk
        http://svn.zope.org/repos/main/zope.i18nmessageid/trunk
        http://svn.zope.org/repos/main/zope.index/trunk
        http://svn.zope.org/repos/main/zope.interface/trunk
        http://svn.zope.org/repos/main/grokproject/trunk

# Do not test zope.proxy with python 2.7
[trunk_repos_plus_crontab_grokproject_C_extentions_proxy]
repos = ${trunk_repos_plus_crontab_grokproject_C_extentions:repos}
        http://svn.zope.org/repos/main/zope.security/trunk
        http://svn.zope.org/repos/main/zope.container/trunk
        http://svn.zope.org/repos/main/zope.proxy/trunk

[zopetoolkit_parameters]
repos = http://svn.zope.org/repos/main/zopetoolkit/trunk
test = bin/test-ztk
       bin/test-zopeapp
buildout = bin/buildout -v
mailto = zope-tests@zope.org
mailmode = all

[zopetoolkit_parameters-win]
repos = ${zopetoolkit_parameters:repos}
test = bin\test-ztk
       bin\test-zopeapp
buildout = bin\buildout -v
mailto = zope-tests@zope.org
mailmode = all

[zopetoolkit-1.0_parameters]
repos = http://svn.zope.org/repos/main/zopetoolkit/branches/1.0
test = bin/test-ztk
       bin/test-zopeapp
buildout = bin/buildout -v
mailto = zope-tests@zope.org
mailmode = all

[zopetoolkit-1.0_parameters-win]
repos = ${zopetoolkit-1.0_parameters:repos}
test = bin\test-ztk
       bin\test-zopeapp
buildout = bin\buildout -v
mailto = zope-tests@zope.org
mailmode = all

[zopetoolkit-1.1_parameters]
repos = http://svn.zope.org/repos/main/zopetoolkit/branches/1.1
test = bin/test-ztk
       bin/test-zopeapp
buildout = bin/buildout -v
mailto = zope-tests@zope.org
mailmode = all

[zopetoolkit-1.1_parameters-win]
repos = ${zopetoolkit-1.1_parameters:repos}
test = bin\test-ztk
       bin\test-zopeapp
buildout = bin\buildout -v
mailto = zope-tests@zope.org
mailmode = all

[groktoolkit_parameters]
repos = http://svn.zope.org/repos/main/groktoolkit/trunk
buildout = bin/buildout -v -c buildbot.cfg
test = bin/test-grok

[groktoolkit_parameters-win]
repos = ${groktoolkit_parameters:repos}
test = bin\test-grok
buildout = bin\buildout -v -c buildbot.cfg

[groktoolkit-1.2_parameters]
repos = http://svn.zope.org/repos/main/groktoolkit/branches/1.2
test = bin/test-grok

[groktoolkit-1.2_parameters-win]
repos = ${groktoolkit-1.2_parameters:repos}
test = bin\test-grok

[zope2.12_parameters]
repos = http://svn.zope.org/repos/main/Zope/branches/2.12
test = bin/alltests
mailto = zope-tests@zope.org
mailmode = all

[zope2.13_parameters]
repos = http://svn.zope.org/repos/main/Zope/branches/2.13
test = bin/alltests
mailto = zope-tests@zope.org
mailmode = all

[zope2.13_parameters-win]
repos = http://svn.zope.org/repos/main/Zope/branches/2.13
test = bin\alltests
mailto = zope-tests@zope.org
mailmode = all

[zope2.14_parameters]
repos = http://svn.zope.org/repos/main/Zope/trunk
test = bin/alltests
mailto = zope-tests@zope.org
mailmode = all

[gocept.selenium-selenium-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.6 bootstrap.py -c selenium.cfg
buildout = bin/buildout -v -c selenium.cfg
slaves = slave-ubuntu32
_test_timeout = 300

[gocept.selenium-static-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.6 bootstrap.py -c static.cfg
buildout = bin/buildout -v -c static.cfg
slaves = slave-ubuntu32
_test_timeout = 300

[gocept.selenium-wsgi-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.6 bootstrap.py -c wsgi.cfg
buildout = bin/buildout -v -c wsgi.cfg
slaves = slave-ubuntu32

[gocept.selenium-ztk-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.6 bootstrap.py -c ztk.cfg
buildout = bin/buildout -v -c ztk.cfg
slaves = slave-ubuntu32

[gocept.selenium-zope210-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.4 bootstrap.py -c zope210.cfg
buildout = bin/buildout -v -c zope210.cfg
slaves = slave-ubuntu32

[gocept.selenium-zope212-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.6 bootstrap.py -c zope212.cfg
buildout = bin/buildout -v -c zope212.cfg
slaves = slave-ubuntu32

[gocept.selenium-grok-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.6 bootstrap.py -c grok.cfg
buildout = bin/buildout -v -c grok.cfg
slaves = slave-ubuntu32

[gocept.selenium-plone3-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.4 bootstrap.py -c plone3.cfg
buildout = bin/buildout -v -c plone3.cfg
slaves = slave-ubuntu32

[gocept.selenium-plone4-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.6 bootstrap.py -c plone4.cfg
buildout = bin/buildout -v -c plone4.cfg
slaves = slave-ubuntu32

[gocept.selenium-plonetesting-zope210-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.4 bootstrap.py -c plonetesting-zope210.cfg
buildout = bin/buildout -v -c plonetesting-zope210.cfg
slaves = slave-ubuntu32

[gocept.selenium-plonetesting-zope212-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.6 bootstrap.py -c plonetesting-zope212.cfg
buildout = bin/buildout -v -c plonetesting-zope212.cfg
slaves = slave-ubuntu32

[gocept.selenium-plonetesting-plone3-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.4 bootstrap.py -c plonetesting-plone3.cfg
buildout = bin/buildout -v -c plonetesting-plone3.cfg
slaves = slave-ubuntu32

[gocept.selenium-plonetesting-plone3-zope211-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.4 bootstrap.py -c plonetesting-plone3-zope211.cfg
buildout = bin/buildout -v -c plonetesting-plone3-zope211.cfg
slaves = slave-ubuntu32

[gocept.selenium-plonetesting-plone4-parameters]
repos = http://svn.zope.org/repos/main/gocept.selenium/trunk
bootstrap = python2.6 bootstrap.py -c plonetesting-plone4.cfg
buildout = bin/buildout -v -c plonetesting-plone4.cfg
slaves = slave-ubuntu32

[fanstatic-parameters]
_vcs = hg
_vcs_mode = clobber
info = hg paths
       hg id
test = bin/py.test
repos = http://bitbucket.org/fanstatic/fanstatic
        http://bitbucket.org/fanstatic/fanstatictemplate

[fanstatic-parameters-win]
<= fanstatic-parameters
test = bin\py.test

[zope.fanstatic-parameters]
_vcs_mode = clobber
repos = http://svn.zope.org/repos/main/zope.fanstatic/trunk

[zope.pytest-parameters]
repos = http://svn.zope.org/repos/main/zope.pytest/trunk
test = bin/py.test

[reboot-slave-macro]
times = @reboot
command = ${buildout:bin-directory}/slave-$${:__name__} start

[reboot-slaves]
recipe = zc.recipe.macro
result-recipe = z3c.recipe.usercrontab
macro = reboot-slave-macro
targets = ubuntu32
          ubuntu64

[reboot-master]
recipe = z3c.recipe.usercrontab
times = @reboot
command = ${buildout:bin-directory}/master start


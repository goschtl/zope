[buildout]
parts = master
        ${projects:result-sections}
        poller
#       grok-trunk
#       grok-1.0
#       grok-1.0-win-projects
#       grok-1.0-win-py2.5
#       groktoolkit
#       zope2-trunk
#       grokdependencies-trunk
versions = versions
extensions = buildout.dumppickedversions
allow-picked-versions = false

[versions]
Paste = 1.7.3
PasteDeploy = 1.3.3
PasteScript = 1.7.3
Twisted = 10.0.0
buildbot = 0.7.12
collective.buildbot = 0.4.1
distribute = 0.6.10
manuel = 1.0.5
buildout.dumppickedversions = 0.4
virtualenv = 1.4.6
zc.buildout = 1.4.3
zc.recipe.egg = 1.2.2
zc.recipe.macro = 1.3.0
zc.recipe.testrunner = 1.2.0
zope.exceptions = 3.5.2
zope.interface = 3.5.3
zope.testing = 3.9.4


[config]
host = localhost


[master]
recipe = collective.buildbot:master
project-name = Zope Buildbot
max-builds = 1
allow-force = true
slaves =
    slave-osx-py2.5 secret
    slave-osx-py2.6 secret
    slave-ubuntu32-py2.5 secret
    slave-ubuntu32-py2.6 secret
    slave-ubuntu64-py2.5 secret
    slave-ubuntu64-py2.6 secret
    slave-win-py2.5 secret
    slave-win-py2.6 secret


[slaves]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:slave
macro = slave-macro
targets = slave-ubuntu32-py2.5:slave-python2.5
          slave-ubuntu32-py2.6
          slave-ubuntu64-py2.5:slave-python2.5
          slave-ubuntu64-py2.6
          slave-win-py2.5:slave-python2.5
          slave-win-py2.6
          
[slave-macro]
host = ${config:host}
port = 8999
password = secret
executable = $${:python}
python = python2.6

[slave-python2.5]
python = python2.5


[poller]
recipe = collective.buildbot:poller
repositories = http://svn.zope.org/repos/main
poll-interval = 3600


[project-macro]
slave-names = $${:slaves}
vcs = svn
vcs-mode = clobber
repositories = $${:repos}
mail-host = localhost
email-notification-sender = no-reply@localhost
email-notification-recipients = root@localhost
build-sequence = 
    $${:bootstrap}
    $${:buildout}
test-sequence = $${:test}
periodic-scheduler = 1440
# sensible defaults
test = bin/test
buildout = bin/buildout -vvv
# XXX only works if the slave is on the same system
bootstrap = python ${buildout:directory}/bootstrap.py 
slaves = slave-ubuntu32-py2.5
         slave-ubuntu32-py2.6
         slave-ubuntu64-py2.5
         slave-ubuntu64-py2.6


[project-win-2.5-defaults]
slaves = slave-win-py2.5
bootstrap = C:\projects\virtualenv-2.5\Scripts\python C:\projects\bootstrap.py
buildout = bin\buildout
test = bin\test

[project-win-2.6-defaults]
slaves = slave-win-py2.6
bootstrap = C:\projects\virtualenv-2.6\Scripts\python C:\projects\bootstrap.py
buildout = bin\buildout
test = bin\test

[project-2.6-defaults]
slaves = slave-ubuntu32-py2.6
         slave-ubuntu64-py2.6

[projects]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:project
macro = project-macro
targets = grokdependencies:grokdependencies-parameters
          grokdependencies-win-2.6:grokdependencies-parameters-win-2.6
          ztk:ztk-parameters
          ztk-win-2.6:ztk-parameters-win-2.6
          groktoolkit:groktoolkit-parameters
          groktoolkit-win-2.6:groktoolkit-parameters-win-2.6
#          grok-trunk:grok-trunk-parameters
#          grok-1.0:grok-1.0-parameters
#          zope2-trunk:zope2-trunk-parameters


[grokdependencies-parameters]
repos = 
    http://svn.zope.org/repos/main/grokcore.annotation/trunk
    http://svn.zope.org/repos/main/grokcore.component/trunk
    http://svn.zope.org/repos/main/grokcore.component/branches/1.x
    http://svn.zope.org/repos/main/grokcore.formlib/trunk
    http://svn.zope.org/repos/main/grokcore.security/trunk
    http://svn.zope.org/repos/main/grokcore.security/branches/1.2
    http://svn.zope.org/repos/main/grokcore.site/trunk
    http://svn.zope.org/repos/main/grokcore.startup/trunk
    http://svn.zope.org/repos/main/grokcore.view/trunk
    http://svn.zope.org/repos/main/grokcore.view/branches/1.13
    http://svn.zope.org/repos/main/grokcore.viewlet/trunk
    http://svn.zope.org/repos/main/grokui.admin/trunk
    http://svn.zope.org/repos/main/martian/trunk
    http://svn.zope.org/repos/main/martian/branches/0.11
    http://svn.zope.org/repos/main/grokproject/trunk
    http://svn.zope.org/repos/main/grokui.introspector/trunk

[grokdependencies-parameters-win-2.6]
<= project-win-2.6-defaults
repos = ${grokdependencies-parameters:repos}



[ztk-parameters]
<= project-2.6-defaults
repos = http://svn.zope.org/repos/main/zopetoolkit/trunk
test = bin/test-ztk

[ztk-parameters-win-2.6]
<= project-win-2.6-defaults
repos = ${ztk-parameters:repos}
test = bin\test-ztk


[groktoolkit-parameters]
<= project-2.6-defaults
repos = http://svn.zope.org/repos/main/groktoolkit/trunk
test = bin/test-grok

[groktoolkit-parameters-win-2.6]
<= project-win-2.6-defaults
repos = ${groktoolkit-parameters:repos}
test = bin\test-grok




[zope2-trunk-parameters]
repos = 
    http://svn.zope.org/repos/main/Zope/trunk
bootstrap = python bootstrap.py
test = bin/alltests


[ztk-win-macro]
<= project-macro
repos =
    ${ztk-parameters:repos}
slave-names = slave-win-py2.$${:version_minor}
bootstrap = $${:python-path} $${:bootstrap-path}
test = bin\test-ztk


[ztk-win-projects]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:project
macro = ztk-win-macro
targets = ztk-win-py2.5:slave-win-py2.5
          ztk-win-py2.6:slave-win-py2.6


[grok-trunk-parameters]
repos =
    http://svn.zope.org/repos/main/grok/trunk
test = bin/compattest
slaves = slave-osx-py2.5
         slave-osx-py2.6
         slave-ubuntu32-py2.5
         slave-ubuntu32-py2.6
         slave-ubuntu64-py2.5
         slave-ubuntu64-py2.6


[grok-trunk-win-macro]
repositories =
    ${grok-trunk-parameters:repos}
slave-names = slave-win-py2.$${:version_minor}
vcs-mode = ${project-macro:vcs-mode}
mail-host = ${project-macro:mail-host}
email-notification-sender = ${project-macro:email-notification-sender}
email-notification-recipients = ${project-macro:email-notification-recipients}
build-sequence =
    $${:python-path} bootstrap\bootstrap.py
    bin\buildout -vvv
test = bin\compattest


[grok-trunk-win-projects]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:project
macro = grok-trunk-win-macro
targets = grok-trunk-win-py2.5:slave-win-py2.5
          grok-trunk-win-py2.6:slave-win-py2.6


[grok-1.0-parameters]
repositories =
    http://svn.zope.org/repos/main/grok/branches/1.0
test = bin/test-grokcore
slaves = slave-osx-py2.5
         slave-ubuntu32-py2.5
         slave-ubuntu64-py2.5


[grok-1.0-win-macro]
repositories =
    ${grok-1.0-parameters:repositories}
slave-names = slave-win-py2.$${:version_minor}
vcs-mode = ${project-macro:vcs-mode}
mail-host = ${project-macro:mail-host}
email-notification-sender = ${project-macro:email-notification-sender}
email-notification-recipients = ${project-macro:email-notification-recipients}
build-sequence =
    $${:python-path} bootstrap\bootstrap.py
    bin\buildout -vvv
test = bin\test-grokcore


[grok-1.0-win-projects]
recipe = zc.recipe.macro
result-recipe = collective.buildbot:project
macro = grok-1.0-win-macro
targets = grok-1.0-win-py2.5:slave-win-py2.5



[python2.5]
version_minor = 5


[python2.6]
version_minor = 6

